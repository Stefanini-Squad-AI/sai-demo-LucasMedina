import{u as Y,j as e,a as M,B as i,g as h,b as t,P as j,aO as L,S as c,i as O,z as q,d as g,U as B,W as R,v as z,ab as F,aC as K,aP as D,at as H,A as N}from"./mui-bVcw8cZ8.js";import{r as d}from"./vendor-BPyidg2q.js";import{S as U,a as v}from"./SystemHeader-DB4NlgIL.js";import{g as $,L as E}from"./index-85Pf7yId.js";import{u as T}from"./useApi-EeZ7am_M.js";import"./router-DEfLtG0k.js";import"./redux-B6kvt0Aa.js";function G(){const[r,a]=d.useState("input"),[l,x]=d.useState(""),[s,u]=d.useState(null),b=d.useCallback((n,o=!1)=>(console.log("ðŸŽ¯ Determining step from response:",{data:n,isProcessingPayment:o}),n.success?o&&n.transactionId&&n.paymentAmount?"success":n.currentBalance===0&&!n.transactionId&&!n.paymentAmount&&(n.message?.includes("Confirm to make a bill payment")||n.message?.includes("already paid")||n.message?.includes("nothing to pay"))?"already-paid":n.currentBalance&&n.currentBalance>0?"confirm":"already-paid":"error"),[]),{mutate:y,loading:C,error:m}=T(n=>$.get("/bill-payment/consult?accountId="+n.accountId),{onSuccess:n=>{console.log("âœ… Lookup account success:",n),u(n);const o=b(n,!1);a(o)},onError:n=>{console.error("âŒ Lookup account error:",n),a("error")}}),{mutate:f,loading:A,error:k}=T(n=>$.post("/bill-payment/process",n),{onSuccess:n=>{console.log("âœ… Process payment success:",n),u(n);const o=b(n,!0);a(o)},onError:n=>{console.error("âŒ Process payment error:",n),a("error")}}),I=d.useCallback(n=>{if(!n.trim())return;const o=parseInt(n,10);isNaN(o)||(console.log("ðŸ” Looking up account:",o),x(n),a("processing"),y({accountId:o,confirmation:""}))},[y]),w=d.useCallback(n=>{if(!l||!s)return;const o=parseInt(l,10);console.log("ðŸ’³ Processing payment confirmation:",{accountId:o,confirm:n}),a("processing"),f({accountId:o,confirmation:n?"Y":"N"})},[l,s,f]),P=d.useCallback(()=>{console.log("ðŸ”„ Resetting form"),a("input"),x(""),u(null)},[]);return{step:r,accountId:l,accountData:s,loading:C||A,error:s?.errorMessage||m||k,handleAccountLookup:I,handlePaymentConfirm:w,resetForm:P}}function J(){const r=Y(),[a,l]=d.useState(""),{step:x,accountData:s,loading:u,error:b,handleAccountLookup:y,handlePaymentConfirm:C,resetForm:m}=G(),f=d.useCallback(p=>{p.preventDefault(),y(a)},[a,y]),A=d.useCallback(p=>{const S=p.target.value;S.length<=11&&/^\d*$/.test(S)&&l(S)},[]),k=d.useCallback(p=>{p.key==="F3"||p.key==="Escape"?(p.preventDefault(),m(),l("")):p.key==="F4"&&(p.preventDefault(),l(""))},[m]),I=()=>e.jsxs(j,{elevation:2,sx:{borderRadius:3,overflow:"hidden",background:`linear-gradient(145deg, ${h(r.palette.background.paper,.9)}, ${h(r.palette.background.default,.1)})`},children:[e.jsxs(i,{sx:{p:3,textAlign:"center",background:`linear-gradient(135deg, ${r.palette.primary.main}, ${r.palette.secondary.main})`,color:"white"},children:[e.jsx(L,{sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"h5",fontWeight:600,children:"Bill Payment"})]}),e.jsxs(i,{sx:{p:4},children:[e.jsx(t,{variant:"h6",color:"primary.main",textAlign:"center",gutterBottom:!0,sx:{mb:3},children:"Enter Account ID to view current balance"}),e.jsx(i,{component:"form",onSubmit:f,sx:{maxWidth:400,mx:"auto"},children:e.jsxs(c,{spacing:3,children:[e.jsx(O,{label:"Enter Acct ID",value:a,onChange:A,disabled:u,autoFocus:!0,placeholder:"12345678901",helperText:"Enter the 11-digit account number",inputProps:{maxLength:11,style:{textAlign:"center",fontSize:"1.1rem",fontWeight:600}},InputProps:{startAdornment:e.jsx(q,{color:"primary",sx:{mr:1}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(g,{type:"submit",variant:"contained",size:"large",disabled:!a||u,startIcon:u?e.jsx(E,{size:20}):e.jsx(L,{}),sx:{py:1.5,borderRadius:2,fontWeight:600},children:u?"Looking up account...":"Continue"})]})})]})]}),w=()=>e.jsxs(j,{elevation:2,sx:{borderRadius:3,overflow:"hidden"},children:[e.jsx(B,{sx:{mb:3},children:e.jsxs(R,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,color:"primary.main",children:"Account Information"}),e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(t,{variant:"body1",children:["Account ID: ",e.jsx("strong",{children:s?.accountId})]}),e.jsx(z,{label:"Active",color:"success",size:"small"})]})]})}),e.jsxs(i,{sx:{p:3,textAlign:"center",bgcolor:h(r.palette.info.main,.1),border:`1px solid ${r.palette.info.main}`,borderRadius:2,mb:3},children:[e.jsx(t,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"Your current balance is:"}),e.jsx(t,{variant:"h4",color:"primary.main",fontWeight:700,sx:{mb:2},children:v(s?.currentBalance||0)})]}),e.jsxs(i,{sx:{p:3},children:[e.jsx(t,{variant:"h6",textAlign:"center",color:"text.primary",gutterBottom:!0,children:"Do you want to pay your balance now? Please confirm:"}),e.jsx(c,{direction:"row",spacing:2,justifyContent:"center",sx:{mt:3},children:e.jsx(g,{variant:"contained",color:"success",size:"large",startIcon:e.jsx(F,{}),onClick:()=>C(!0),disabled:u,sx:{minWidth:120},children:"Yes (Y)"})}),u&&e.jsxs(i,{sx:{display:"flex",justifyContent:"center",mt:3},children:[e.jsx(E,{}),e.jsx(t,{variant:"body2",sx:{ml:2},children:"Processing payment..."})]})]})]}),P=()=>e.jsxs(j,{elevation:2,sx:{borderRadius:3,p:4,textAlign:"center"},children:[e.jsx(E,{size:64}),e.jsx(t,{variant:"h6",sx:{mt:2},children:"Processing your request..."}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Please wait while we process your bill payment"})]}),W=()=>e.jsxs(j,{elevation:2,sx:{borderRadius:3,overflow:"hidden",textAlign:"center"},children:[e.jsxs(i,{sx:{p:4,background:`linear-gradient(135deg, ${r.palette.success.main}, ${r.palette.success.dark})`,color:"white"},children:[e.jsx(F,{sx:{fontSize:64,mb:2}}),e.jsx(t,{variant:"h4",fontWeight:600,gutterBottom:!0,children:"Payment Successful!"}),e.jsx(t,{variant:"h6",sx:{opacity:.9},children:s?.message})]}),e.jsxs(i,{sx:{p:4},children:[e.jsx(B,{sx:{mb:3,bgcolor:h(r.palette.success.main,.1)},children:e.jsx(R,{children:e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"body1",children:"Transaction ID:"}),e.jsx(t,{variant:"body1",fontWeight:600,children:s?.transactionId})]}),e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"body1",children:"Amount Paid:"}),e.jsx(t,{variant:"body1",fontWeight:600,children:v(s?.paymentAmount||0)})]}),e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"body1",children:"New Balance:"}),e.jsx(t,{variant:"body1",fontWeight:600,color:"success.main",children:v(s?.currentBalance||0)})]})]})})}),e.jsxs(c,{direction:"row",spacing:2,justifyContent:"center",children:[e.jsx(g,{variant:"contained",startIcon:e.jsx(K,{}),onClick:()=>{console.log("Print receipt for transaction:",s?.transactionId)},children:"Print Receipt"}),e.jsx(g,{variant:"outlined",startIcon:e.jsx(D,{}),onClick:()=>{m(),l("")},children:"New Payment"})]})]})]}),n=()=>e.jsxs(j,{elevation:2,sx:{borderRadius:3,overflow:"hidden",textAlign:"center"},children:[e.jsxs(i,{sx:{p:4,background:`linear-gradient(135deg, ${r.palette.info.main}, ${r.palette.info.dark})`,color:"white"},children:[e.jsx(H,{sx:{fontSize:64,mb:2}}),e.jsx(t,{variant:"h4",fontWeight:600,gutterBottom:!0,children:"Account Already Paid"}),e.jsx(t,{variant:"h6",sx:{opacity:.9},children:"This account has no outstanding balance"})]}),e.jsxs(i,{sx:{p:4},children:[e.jsx(B,{sx:{mb:3,bgcolor:h(r.palette.info.main,.1)},children:e.jsx(R,{children:e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"body1",children:"Account ID:"}),e.jsx(t,{variant:"body1",fontWeight:600,children:s?.accountId})]}),e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"body1",children:"Current Balance:"}),e.jsx(t,{variant:"body1",fontWeight:600,color:"success.main",children:v(s?.currentBalance||0)})]}),e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"body1",children:"Status:"}),e.jsx(z,{label:"Paid in Full",color:"success",size:"small"})]})]})})}),e.jsx(N,{severity:"info",sx:{mb:3,borderRadius:2},children:e.jsx(t,{variant:"body1",children:s?.message||"Your account balance is already paid in full. No payment is required at this time."})}),e.jsx(g,{variant:"outlined",startIcon:e.jsx(D,{}),onClick:()=>{m(),l("")},children:"Check Another Account"})]})]}),o=()=>e.jsxs(j,{elevation:2,sx:{borderRadius:3,p:4,textAlign:"center"},children:[e.jsxs(N,{severity:"error",sx:{mb:3,borderRadius:2},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Payment Error"}),e.jsx(t,{variant:"body1",children:b||"An unexpected error occurred"})]}),e.jsx(g,{variant:"outlined",startIcon:e.jsx(D,{}),onClick:()=>{m(),l("")},children:"Try Again"})]});return e.jsx(M,{maxWidth:"md",sx:{py:3},children:e.jsxs(i,{onKeyDown:k,tabIndex:-1,children:[e.jsx(U,{transactionId:"CB00",programName:"COBIL00C",title:"CardDemo - Bill Payment",subtitle:"Pay Account Balance in Full"}),x==="input"&&I(),x==="confirm"&&w(),x==="processing"&&P(),x==="success"&&W(),x==="already-paid"&&n(),x==="error"&&o(),e.jsx(i,{sx:{mt:3,p:2,bgcolor:h(r.palette.grey[100],.5),borderRadius:2,textAlign:"center"},children:e.jsx(t,{variant:"body2",color:"text.secondary",children:"ENTER = Continue â€¢ F3 = Back â€¢ F4 = Clear"})})]})})}function te(){return e.jsx(J,{})}export{te as default};
