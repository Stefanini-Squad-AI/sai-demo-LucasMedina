const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-BMDBCpLQ.js","assets/mui-bVcw8cZ8.js","assets/vendor-BPyidg2q.js","assets/SystemHeader-DB4NlgIL.js","assets/router-DEfLtG0k.js","assets/redux-B6kvt0Aa.js","assets/MainMenuPage-4T0H5qWU.js","assets/menuData-DwI0ORVA.js","assets/AdminMenuPage-8KL8GgfL.js","assets/not-found-8zRN0pSi.js","assets/AccountViewPage-CaT892-w.js","assets/useApi-EeZ7am_M.js","assets/AccountUpdatePage--k7EKD1-.js","assets/CreditCardListPage-67Zubsdt.js","assets/CreditCardViewPage-Cy5Ziijn.js","assets/CreditCardUpdatePage-B1xC7aN3.js","assets/TransactionAddPage-CiUv0IRq.js","assets/TransactionListPage-BXFpQ6Ai.js","assets/TransactionViewPage-DMgnJUem.js","assets/TransactionReportsPage-rXOsa3Pf.js","assets/BillPaymentPage-dHebbGxf.js","assets/UserListPage-Bes1hTTa.js","assets/UserAddPage-QI2KTovP.js","assets/userApi-BJ-es0VP.js","assets/UserUpdatePage-CtZiHi9i.js","assets/UserDeletePage-DqbU1hX1.js"])))=>i.map(i=>d[i]);
import{c as B,j as r,T as ee,C as re,a as te,P as oe,B as V,E as se,b as I,A as ne,S as ae,d as R,R as ie,H as ce,F as le,e as de}from"./mui-bVcw8cZ8.js";import{c as ue,r as v,a as h}from"./vendor-BPyidg2q.js";import{u as fe,a as $,N as E,R as he,b as m,B as me}from"./router-DEfLtG0k.js";import{c as _,a as W,b as pe,P as ge,u as xe,d as ye}from"./redux-B6kvt0Aa.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var C={},N=ue;C.createRoot=N.createRoot,C.hydrateRoot=N.hydrateRoot;const be="modulepreload",ve=function(o){return"/demo-sai-3-aws/"+o},H={},p=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=d?.nonce||d?.getAttribute("nonce");s=Promise.allSettled(t.map(g=>{if(g=ve(g),g in H)return;H[g]=!0;const i=g.endsWith(".css"),f=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${f}`))return;const b=document.createElement("link");if(b.rel=i?"stylesheet":be,i||(b.as="script"),b.crossOrigin="",b.href=g,u&&b.setAttribute("nonce",u),document.head.appendChild(b),i)return new Promise((x,w)=>{b.addEventListener("load",x),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return s.then(d=>{for(const u of d||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})},Se="/api";class S extends Error{constructor(e,t,n){super(e),this.status=t,this.code=n,this.name="ApiError"}}class ke{baseURL;defaultHeaders;constructor(e){this.baseURL=e,this.defaultHeaders={"Content-Type":"application/json"}}async request(e,t={}){const{timeout:n=1e4,headers:s,...a}=t,d=`${this.baseURL}${e}`,u={...this.defaultHeaders,...s},g=localStorage.getItem("auth-token");g&&(u.Authorization=`Bearer ${g}`);try{const i=new AbortController,f=setTimeout(()=>i.abort(),n),x=await fetch(d,{...a,headers:u,signal:i.signal});clearTimeout(f);const w=x.headers.get("content-type"),j=w&&w.includes("application/json");let c;if(j)try{c=await x.json(),console.log("üéØ Raw API response:",c)}catch(Z){throw console.error("Error parsing JSON response:",Z),new S("Invalid JSON response from server",x.status)}else c={success:!1,error:`Server returned ${x.status}: ${x.statusText}`};if(!x.ok)throw c&&typeof c=="object"&&"success"in c&&!c.success?new S(c.errorMessage||c.error||`HTTP ${x.status}: ${x.statusText}`,x.status,c.code):new S(c.error||c.message||`HTTP ${x.status}: ${x.statusText}`,x.status,c.code);if(j&&c&&typeof c=="object"){if("currentDate"in c&&"currentTime"in c&&"transactionId"in c)return console.log("üéØ Backend real response detected"),c;if("success"in c&&c.success===!1)throw new S(c.errorMessage||c.error||"Request failed",x.status);return"success"in c&&c.success===!0?(console.log("üéØ MSW success response detected"),c):"success"in c&&"data"in c?(console.log("üéØ Standard ApiResponse detected"),c):(console.log("üéØ Raw data response, wrapping in ApiResponse"),{success:!0,data:c})}return c}catch(i){throw console.error("üö® API request error:",i),i instanceof S?i:i instanceof Error&&i.name==="AbortError"?new S("Request timeout"):i instanceof TypeError&&i.message.includes("fetch")?new S("Network error - please check your connection"):new S(i instanceof Error?i.message:"Network error")}}async get(e,t){return this.request(e,{...t,method:"GET"})}async post(e,t,n){const s={...n,method:"POST"};return t!==void 0&&(s.body=JSON.stringify(t)),this.request(e,s)}async put(e,t,n){const s={...n,method:"PUT"};return t!==void 0&&(s.body=JSON.stringify(t)),this.request(e,s)}async patch(e,t,n){const s={...n,method:"PATCH"};return t!==void 0&&(s.body=JSON.stringify(t)),this.request(e,s)}async delete(e,t){return this.request(e,{...t,method:"DELETE"})}}const A=new ke(Se),we={user:null,token:localStorage.getItem("auth-token"),isAuthenticated:!1,isLoading:!1,error:null};function z(o){return typeof o=="object"&&o!==null&&"success"in o}const P=_("auth/login",async(o,{rejectWithValue:e})=>{try{const t=await A.post("/auth/login",o);let n;if(z(t))if(t.success&&t.data)n=t.data;else return e(t.error||"Login failed");else n=t;const s={id:1,userId:n.userId,name:n.fullName,role:n.userType==="A"?"admin":"back-office",avatar:`https://i.pravatar.cc/150?u=${n.userId}`,createdAt:new Date().toISOString(),isActive:!0};return localStorage.setItem("auth-token",n.accessToken),localStorage.setItem("refresh-token",n.refreshToken),localStorage.setItem("userRole",s.role),localStorage.setItem("userId",s.userId),sessionStorage.setItem("user-session",JSON.stringify({userId:n.userId,userType:n.userType,role:s.role,loginTime:Date.now()})),{token:n.accessToken,refreshToken:n.refreshToken,user:s,expiresIn:n.expiresIn}}catch(t){return t.status===401?e("Invalid credentials"):t.status===400?e("Please check your input"):e(t.message||"Network error occurred")}}),L=_("auth/logout",async(o,{dispatch:e})=>{try{e(T());try{await A.post("/auth/logout")}catch(t){console.warn("Logout API call failed, but local logout completed:",t)}}catch(t){e(T()),console.warn("Logout process completed despite errors:",t)}return null}),O=_("auth/refreshToken",async(o,{rejectWithValue:e})=>{try{const t=localStorage.getItem("refresh-token");if(!t)return e("No refresh token available");const n=await A.post("/auth/refresh",{refreshToken:t});let s;if(z(n))if(n.success&&n.data)s=n.data;else return e(n.error||"Token refresh failed");else s=n;return localStorage.setItem("auth-token",s.accessToken),s.accessToken}catch(t){return e(t instanceof Error?t.message:"Token refresh failed")}}),D=_("auth/validateToken",async(o,{rejectWithValue:e})=>{try{const t=localStorage.getItem("auth-token"),n=localStorage.getItem("userRole"),s=localStorage.getItem("userId");if(!t)return e("No token available");const a=await A.post("/auth/validate",{token:t});let d;if(z(a))if(a.success&&a.data)d=a.data;else return e("Token validation failed");else d=a;if(d.valid){if(n&&s){const u={id:1,userId:s,name:n==="admin"?"Administrator User":"Back Office User",role:n,avatar:`https://i.pravatar.cc/150?u=${s}`,createdAt:new Date().toISOString(),isActive:!0};return{userId:d.userId,user:u}}return{userId:d.userId}}return e("Token is invalid")}catch(t){return e(t instanceof Error?t.message:"Token validation failed")}}),J=W({name:"auth",initialState:we,reducers:{clearError:o=>{o.error=null},setCredentials:(o,e)=>{o.user=e.payload.user,o.token=e.payload.token,o.isAuthenticated=!0,o.error=null,localStorage.setItem("userRole",e.payload.user.role),localStorage.setItem("userId",e.payload.user.userId)},clearCredentials:o=>{o.user=null,o.token=null,o.isAuthenticated=!1,o.error=null,localStorage.removeItem("auth-token"),localStorage.removeItem("refresh-token"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),sessionStorage.removeItem("user-session")},immediateLogout:o=>{o.user=null,o.token=null,o.isAuthenticated=!1,o.error=null,o.isLoading=!1,localStorage.removeItem("auth-token"),localStorage.removeItem("refresh-token"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),sessionStorage.removeItem("user-session")}},extraReducers:o=>{o.addCase(P.pending,e=>{e.isLoading=!0,e.error=null}).addCase(P.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(P.rejected,(e,t)=>{e.isLoading=!1,e.user=null,e.token=null,e.isAuthenticated=!1,e.error=t.payload}).addCase(L.pending,e=>{e.isLoading=!1}).addCase(L.fulfilled,e=>{e.isLoading=!1}).addCase(L.rejected,e=>{e.isLoading=!1}).addCase(O.fulfilled,(e,t)=>{e.isLoading=!1,e.token=t.payload,e.error=null}).addCase(O.rejected,(e,t)=>{e.isLoading=!1,e.user=null,e.token=null,e.isAuthenticated=!1,e.error=t.payload}).addCase(D.fulfilled,(e,t)=>{e.isAuthenticated=!0,e.error=null,"user"in t.payload&&(e.user=t.payload.user)}).addCase(D.rejected,(e,t)=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.error=t.payload})}}),{clearError:ir,setCredentials:cr,clearCredentials:lr,immediateLogout:T}=J.actions,Ie=J.reducer,M=o=>o.auth.user,U=o=>o.auth.isAuthenticated,je=o=>o.auth.isLoading,dr=o=>o.auth.error,Ee=o=>o.auth.token,Te={initialized:!1,loading:!1,error:null},F=W({name:"app",initialState:Te,reducers:{setInitialized:(o,e)=>{o.initialized=e.payload},setLoading:(o,e)=>{o.loading=e.payload},setError:(o,e)=>{o.error=e.payload},resetApp:o=>{o.initialized=!1,o.loading=!1,o.error=null}}}),{setInitialized:ur,setLoading:fr,setError:hr,resetApp:mr}=F.actions,_e=pe({reducer:{app:F.reducer,auth:Ie},middleware:o=>o({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE","persist/REGISTER"]}}),devTools:!1}),l={primary:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",main:"#1976d2",light:"#42a5f5",dark:"#1565c0",contrastText:"#fff"},secondary:{50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",main:"#9c27b0",light:"#ba68c8",dark:"#7b1fa2",contrastText:"#fff"},success:{50:"#e8f5e8",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",main:"#4caf50",light:"#66bb6a",dark:"#388e3c",contrastText:"#fff"},error:{50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",main:"#f44336",light:"#ef5350",dark:"#d32f2f",contrastText:"#fff"},warning:{50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",main:"#ff9800",light:"#ffa726",dark:"#f57c00",contrastText:"rgba(0, 0, 0, 0.87)"},info:{50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",main:"#03a9f4",light:"#29b6f6",dark:"#0288d1",contrastText:"#fff"},grey:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"}},G={typography:{fontFamily:["Inter","-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),h1:{fontWeight:700,fontSize:"2.5rem",lineHeight:1.2},h2:{fontWeight:700,fontSize:"2rem",lineHeight:1.3},h3:{fontWeight:600,fontSize:"1.75rem",lineHeight:1.3},h4:{fontWeight:600,fontSize:"1.5rem",lineHeight:1.4},h5:{fontWeight:600,fontSize:"1.25rem",lineHeight:1.4},h6:{fontWeight:600,fontSize:"1.125rem",lineHeight:1.4},body1:{fontSize:"1rem",lineHeight:1.6},body2:{fontSize:"0.875rem",lineHeight:1.6},button:{textTransform:"none",fontWeight:600,fontSize:"0.875rem"},caption:{fontSize:"0.75rem",lineHeight:1.4}},shape:{borderRadius:8},spacing:8,breakpoints:{values:{xs:0,sm:600,md:900,lg:1200,xl:1536}}},Ae={...G,palette:{mode:"light",primary:l.primary,secondary:l.secondary,error:l.error,warning:l.warning,info:l.info,success:l.success,grey:l.grey,background:{default:"#fafafa",paper:"#ffffff"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",selected:"rgba(0, 0, 0, 0.08)",disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",focus:"rgba(0, 0, 0, 0.12)"}}},Re={...G,palette:{mode:"dark",primary:{...l.primary,main:l.primary[300],light:l.primary[200],dark:l.primary[400]},secondary:{...l.secondary,main:l.secondary[300],light:l.secondary[200],dark:l.secondary[400]},error:{...l.error,main:l.error[400],light:l.error[300],dark:l.error[500]},warning:{...l.warning,main:l.warning[400],light:l.warning[300],dark:l.warning[500]},info:{...l.info,main:l.info[400],light:l.info[300],dark:l.info[500]},success:{...l.success,main:l.success[400],light:l.success[300],dark:l.success[500]},background:{default:"#121212",paper:"#1e1e1e"},text:{primary:"#ffffff",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",action:{active:"#ffffff",hover:"rgba(255, 255, 255, 0.08)",selected:"rgba(255, 255, 255, 0.16)",disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",focus:"rgba(255, 255, 255, 0.12)"}}},K={MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 16px",fontWeight:600,textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"0 2px 8px rgba(0,0,0,0.15)"}},contained:{"&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.15)"}}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)","&:hover":{boxShadow:"0 4px 16px rgba(0,0,0,0.15)"}}}},MuiPaper:{styleOverrides:{root:{borderRadius:8},elevation1:{boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)"},elevation2:{boxShadow:"0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)"},elevation3:{boxShadow:"0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8}}}},MuiChip:{styleOverrides:{root:{borderRadius:16,fontWeight:500}}},MuiAppBar:{styleOverrides:{root:{boxShadow:"0 1px 3px rgba(0,0,0,0.12)"}}},MuiDrawer:{styleOverrides:{paper:{borderRadius:0}}},MuiDialog:{styleOverrides:{paper:{borderRadius:12}}},MuiTooltip:{styleOverrides:{tooltip:{borderRadius:6,fontSize:"0.75rem"}}}},Pe=B({...Ae,components:K}),Le=B({...Re,components:K}),Ce=v.createContext(void 0);function Oe({children:o}){const[e,t]=v.useState(()=>typeof window<"u"&&localStorage.getItem("theme-mode")||"system"),[n,s]=v.useState(!1);v.useEffect(()=>{const i=()=>{if(e==="system"){const f=window.matchMedia("(prefers-color-scheme: dark)").matches;s(f)}else s(e==="dark")};if(i(),e==="system"){const f=window.matchMedia("(prefers-color-scheme: dark)"),b=()=>i();return f.addEventListener("change",b),()=>f.removeEventListener("change",b)}},[e]),v.useEffect(()=>{localStorage.setItem("theme-mode",e)},[e]);const a=()=>{t(i=>i==="light"?"dark":i==="dark"?"system":"light")},d=i=>{t(i)},u=n?Le:Pe,g={mode:e,toggleTheme:a,setThemeMode:d};return r.jsx(ge,{store:_e,children:r.jsx(Ce.Provider,{value:g,children:r.jsxs(ee,{theme:u,children:[r.jsx(re,{}),o]})})})}class De extends v.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorId:`error_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),this.props.onError?.(e,t),console.error("ErrorBoundary caught an error:",e,t)}handleReload=()=>{window.location.reload()};handleReset=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,errorId:void 0})};handleGoHome=()=>{window.location.href="/"};render(){return this.state.hasError?this.props.fallback?this.props.fallback:r.jsx(te,{maxWidth:"md",sx:{py:8},children:r.jsxs(oe,{elevation:3,sx:{p:4,textAlign:"center",borderRadius:2},children:[r.jsxs(V,{sx:{mb:3},children:[r.jsx(se,{sx:{fontSize:64,color:"error.main",mb:2}}),r.jsx(I,{variant:"h4",component:"h1",gutterBottom:!0,color:"error",children:"Something went wrong"}),r.jsx(I,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"We're sorry, but something unexpected happened. Please try one of the options below."})]}),this.state.errorId&&r.jsxs(ne,{severity:"info",sx:{mb:3,textAlign:"left"},children:[r.jsxs(I,{variant:"body2",children:[r.jsx("strong",{children:"Error ID:"})," ",this.state.errorId]}),r.jsx(I,{variant:"caption",display:"block",sx:{mt:1},children:"Please include this ID when reporting the issue."})]}),r.jsxs(ae,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",sx:{mb:3},children:[r.jsx(R,{variant:"contained",startIcon:r.jsx(ie,{}),onClick:this.handleReload,children:"Reload Page"}),r.jsx(R,{variant:"outlined",onClick:this.handleReset,children:"Try Again"}),r.jsx(R,{variant:"outlined",startIcon:r.jsx(ce,{}),onClick:this.handleGoHome,children:"Go Home"})]}),!1]})}):this.props.children}}function Q({message:o="Loading...",size:e=40,fullScreen:t=!0,color:n="primary",variant:s="indeterminate",value:a,showMessage:d=!0}){return r.jsx(le,{in:!0,timeout:300,children:r.jsxs(V,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,...t&&{minHeight:"100vh",width:"100%"}},children:[r.jsx(de,{size:e,color:n,variant:s,value:a}),d&&o&&r.jsx(I,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",maxWidth:300,px:2},children:o}),s==="determinate"&&a!==void 0&&r.jsxs(I,{variant:"caption",color:"text.secondary",children:[Math.round(a),"%"]})]})})}const X=()=>xe(),k=ye;function Y(){const o=X(),e=fe(),t=k(Ee),n=k(U),s=k(M),a=v.useCallback(()=>{if(!n||!s)return!0;const i=sessionStorage.getItem("user-session");if(!i){console.log("üîç No session data found, but user is authenticated in Redux");const f={userId:s.userId,userType:s.role==="admin"?"A":"U",role:s.role,loginTime:Date.now()};return sessionStorage.setItem("user-session",JSON.stringify(f)),console.log("‚úÖ Recreated session data from Redux state"),!0}try{const f=JSON.parse(i),x=Date.now()-f.loginTime,w=8*60*60*1e3,j=x<w;return j||console.warn("‚è∞ Session expired:",{sessionAge:Math.floor(x/1e3/60),maxTime:Math.floor(w/1e3/60)}),j}catch(f){if(console.error("‚ùå Error parsing session data:",f),s){const b={userId:s.userId,userType:s.role==="admin"?"A":"U",role:s.role,loginTime:Date.now()};return sessionStorage.setItem("user-session",JSON.stringify(b)),console.log("‚úÖ Recreated session data after parse error"),!0}return!1}},[n,s]),d=v.useCallback(async()=>{try{return console.log("üîÑ Attempting token refresh..."),await o(O()).unwrap(),console.log("‚úÖ Token refreshed successfully"),!0}catch(i){return console.error("‚ùå Token refresh failed:",i),o(T()),e("/login"),!1}},[o,e]),u=v.useCallback(()=>{console.log("üßπ Clearing session and redirecting to login..."),o(T()),e("/login",{replace:!0})},[o,e]),g=v.useCallback(()=>{console.log("üö™ Performing immediate logout..."),o(T()),e("/login",{replace:!0})},[o,e]);return v.useEffect(()=>{if(!n||!t||!s)return;console.log("‚è±Ô∏è Starting session monitoring for user:",s.userId);const i=setInterval(()=>{if(!a()){console.warn("‚ö†Ô∏è Session expired, clearing credentials"),u();return}const f=localStorage.getItem("refresh-token");f&&f.startsWith("mock-refresh-token-")&&d().catch(()=>{console.warn("‚ö†Ô∏è Failed to refresh token, session may expire soon")})},5*60*1e3);return()=>{console.log("üõë Stopping session monitoring for user:",s.userId),clearInterval(i)}},[n,t,s,a,d,u]),v.useEffect(()=>{const i=()=>{console.log("üëã Window closing, cleaning session storage"),sessionStorage.removeItem("user-session")},f=()=>{document.visibilityState==="visible"&&n&&s&&(a()||(console.warn("‚ö†Ô∏è Session expired while tab was hidden"),u()))};return window.addEventListener("beforeunload",i),document.addEventListener("visibilitychange",f),()=>{window.removeEventListener("beforeunload",i),document.removeEventListener("visibilitychange",f)}},[n,s,a,u]),{checkSessionExpiry:a,attemptTokenRefresh:d,clearSession:u,performImmediateLogout:g}}function y({children:o,requiredRole:e}){const t=X(),n=$(),s=k(U),a=k(M),d=k(je),{checkSessionExpiry:u}=Y();if(v.useEffect(()=>{localStorage.getItem("auth-token")&&!s&&t(D())},[t,s]),d)return r.jsx(Q,{});if(!s||!a)return r.jsx(E,{to:"/login",state:{from:n},replace:!0});if(!u())return r.jsx(E,{to:"/login",state:{from:n},replace:!0});if(e&&a.role!==e){const g=a.role==="admin"?"/menu/admin":"/menu/main";return r.jsx(E,{to:g,replace:!0})}return r.jsx(r.Fragment,{children:o})}const ze=h.lazy(()=>p(()=>import("./LoginPage-BMDBCpLQ.js"),__vite__mapDeps([0,1,2,3,4,5]))),Me=h.lazy(()=>p(()=>import("./MainMenuPage-4T0H5qWU.js"),__vite__mapDeps([6,1,2,7,3,4,5]))),Ue=h.lazy(()=>p(()=>import("./AdminMenuPage-8KL8GgfL.js"),__vite__mapDeps([8,1,2,7,3,4,5])));h.lazy(()=>p(()=>import("./not-found-8zRN0pSi.js"),__vite__mapDeps([9,1,2,4,5])));const Ne=h.lazy(()=>p(()=>import("./AccountViewPage-CaT892-w.js"),__vite__mapDeps([10,1,2,3,4,11,5]))),He=h.lazy(()=>p(()=>import("./AccountUpdatePage--k7EKD1-.js"),__vite__mapDeps([12,1,2,3,4,11,5]))),qe=h.lazy(()=>p(()=>import("./CreditCardListPage-67Zubsdt.js"),__vite__mapDeps([13,1,2,3,4,11,5]))),Be=h.lazy(()=>p(()=>import("./CreditCardViewPage-Cy5Ziijn.js"),__vite__mapDeps([14,1,2,3,4,11,5]))),Ve=h.lazy(()=>p(()=>import("./CreditCardUpdatePage-B1xC7aN3.js"),__vite__mapDeps([15,1,2,3,4,11,5]))),$e=h.lazy(()=>p(()=>import("./TransactionAddPage-CiUv0IRq.js"),__vite__mapDeps([16,1,2,3,4,11,5]))),We=h.lazy(()=>p(()=>import("./TransactionListPage-BXFpQ6Ai.js"),__vite__mapDeps([17,1,2,3,4,11,5]))),Je=h.lazy(()=>p(()=>import("./TransactionViewPage-DMgnJUem.js"),__vite__mapDeps([18,1,2,3,4,11,5]))),Fe=h.lazy(()=>p(()=>import("./TransactionReportsPage-rXOsa3Pf.js"),__vite__mapDeps([19,1,2,3,4,11,5]))),Ge=h.lazy(()=>p(()=>import("./BillPaymentPage-dHebbGxf.js"),__vite__mapDeps([20,1,2,3,4,11,5]))),Ke=h.lazy(()=>p(()=>import("./UserListPage-Bes1hTTa.js"),__vite__mapDeps([21,1,2,3,4,11,5]))),Qe=h.lazy(()=>p(()=>import("./UserAddPage-QI2KTovP.js"),__vite__mapDeps([22,1,2,3,4,11,23,5]))),Xe=h.lazy(()=>p(()=>import("./UserUpdatePage-CtZiHi9i.js"),__vite__mapDeps([24,1,2,3,4,11,23,5]))),Ye=h.lazy(()=>p(()=>import("./UserDeletePage-DqbU1hX1.js"),__vite__mapDeps([25,1,2,3,4,11,23,5])));function q(){const o=k(U),e=k(M),t=$();if(!o||!e)return r.jsx(E,{to:"/login",state:{from:t},replace:!0});const n=e.role==="admin"?"/menu/admin":"/menu/main";return r.jsx(E,{to:n,replace:!0})}function Ze(){return Y(),r.jsx(De,{children:r.jsx(h.Suspense,{fallback:r.jsx(Q,{}),children:r.jsxs(he,{children:[r.jsx(m,{path:"/",element:r.jsx(q,{})}),r.jsx(m,{path:"/login",element:r.jsx(ze,{})}),r.jsx(m,{path:"/menu/main",element:r.jsx(y,{requiredRole:"back-office",children:r.jsx(Me,{})})}),r.jsx(m,{path:"/menu/admin",element:r.jsx(y,{requiredRole:"admin",children:r.jsx(Ue,{})})}),r.jsx(m,{path:"/accounts/view",element:r.jsx(y,{children:r.jsx(Ne,{})})}),r.jsx(m,{path:"/accounts/update",element:r.jsx(y,{children:r.jsx(He,{})})}),r.jsx(m,{path:"/cards/list",element:r.jsx(y,{children:r.jsx(qe,{})})}),r.jsx(m,{path:"/cards/view",element:r.jsx(y,{children:r.jsx(Be,{})})}),r.jsx(m,{path:"/cards/update",element:r.jsx(y,{children:r.jsx(Ve,{})})}),r.jsx(m,{path:"/transactions/list",element:r.jsx(y,{children:r.jsx(We,{})})}),r.jsx(m,{path:"/transactions/view/:transactionId?",element:r.jsx(y,{children:r.jsx(Je,{})})}),r.jsx(m,{path:"/transactions/add",element:r.jsx(y,{children:r.jsx($e,{})})}),r.jsx(m,{path:"/reports/transactions",element:r.jsx(y,{children:r.jsx(Fe,{})})}),r.jsx(m,{path:"/payments/bills",element:r.jsx(y,{children:r.jsx(Ge,{})})}),r.jsx(m,{path:"/admin/users/list",element:r.jsx(y,{requiredRole:"admin",children:r.jsx(Ke,{})})}),r.jsx(m,{path:"/admin/users/add",element:r.jsx(y,{requiredRole:"admin",children:r.jsx(Qe,{})})}),r.jsx(m,{path:"/admin/users/update",element:r.jsx(y,{requiredRole:"admin",children:r.jsx(Xe,{})})}),r.jsx(m,{path:"/admin/users/delete",element:r.jsx(y,{requiredRole:"admin",children:r.jsx(Ye,{})})}),r.jsx(m,{path:"*",element:r.jsx(q,{})})]})})})}function er(){return r.jsx(Oe,{children:r.jsx(Ze,{})})}async function rr(){{const{worker:o}=await p(async()=>{const{worker:n}=await import("./browser-Me-4vM3v.js");return{worker:n}},[]),t="/demo-sai-3-aws/mockServiceWorker.js";return await o.start({onUnhandledRequest:"bypass",serviceWorker:{url:t}}),console.log("üî∂ MSW enabled with service worker at:",t),o}}async function tr(){console.log("üî∂ Starting application with MSW mocks"),await rr()}tr().then(()=>{C.createRoot(document.getElementById("root")).render(r.jsx(h.StrictMode,{children:r.jsx(me,{children:r.jsx(er,{})})}))});export{S as A,Q as L,k as a,dr as b,U as c,M as d,ir as e,L as f,A as g,P as l,je as s,X as u};
