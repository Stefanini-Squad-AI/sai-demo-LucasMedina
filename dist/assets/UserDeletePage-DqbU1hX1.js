import{u as L,j as e,a as z,B as o,P as K,g as b,b as l,a4 as F,i as T,d as y,G,D as H,S as W,v as V,o as q,l as J,A as Q,K as X,aR as M,ae as Y,y as Z,a9 as _,aa as ee,ac as re,ad as te}from"./mui-bVcw8cZ8.js";import{r as a}from"./vendor-BPyidg2q.js";import{S as se}from"./SystemHeader-DB4NlgIL.js";import{u as ne,d as ae}from"./router-DEfLtG0k.js";import{u as A}from"./useApi-EeZ7am_M.js";import{g as E,L as ie}from"./index-85Pf7yId.js";import"./userApi-BJ-es0VP.js";import"./redux-B6kvt0Aa.js";function oe({formData:m,errors:j,loading:d,message:u,messageType:c,userData:s,onFormChange:g,onFetchUser:p,onDelete:I,onClear:i,onExit:f}){const r=L(),[x,h]=a.useState(!1),C=a.useCallback(n=>{n.key==="F3"||n.key==="Escape"?(n.preventDefault(),f()):n.key==="F4"?(n.preventDefault(),i()):n.key==="F5"?(n.preventDefault(),s&&h(!0)):n.key==="F12"&&(n.preventDefault(),f())},[f,i,s]),U=a.useCallback(n=>{n.preventDefault(),p()},[p]),k=a.useCallback(()=>{h(!1),I()},[I]),v=s!==null,S=n=>n==="A"?"Admin":"User";return e.jsx(z,{maxWidth:"lg",sx:{py:3},children:e.jsxs(o,{onKeyDown:C,tabIndex:-1,children:[e.jsx(se,{transactionId:"CU03",programName:"COUSR03C",title:"Delete User",subtitle:"User Security Management"}),e.jsxs(K,{elevation:2,sx:{borderRadius:3,overflow:"hidden",background:`linear-gradient(145deg, ${b(r.palette.background.paper,.9)}, ${b(r.palette.background.default,.1)})`},children:[e.jsx(o,{sx:{p:3,background:`linear-gradient(135deg, ${r.palette.error.main}, ${r.palette.error.dark})`,color:"white"},children:e.jsxs(l,{variant:"h5",fontWeight:600,gutterBottom:!0,children:[e.jsx(F,{sx:{mr:1,verticalAlign:"middle"}}),"Delete User Information"]})}),e.jsx(o,{sx:{p:3,bgcolor:b(r.palette.info.main,.05)},children:e.jsxs(o,{component:"form",onSubmit:U,sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[e.jsx(l,{variant:"body1",fontWeight:600,color:"primary.main",children:"Enter User ID:"}),e.jsx(T,{value:m.userId,onChange:n=>g("userId",n.target.value.toUpperCase()),placeholder:"USER001",size:"small",disabled:d,error:!!j.userId,helperText:j.userId,inputProps:{maxLength:8,style:{textAlign:"center",fontSize:"1rem",fontWeight:600}},sx:{width:150,"& .MuiOutlinedInput-root":{bgcolor:"white","&:hover":{"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main,borderWidth:2}}}}}),e.jsx(y,{type:"submit",variant:"contained",disabled:d||!m.userId.trim(),startIcon:e.jsx(G,{}),sx:{fontWeight:600},children:"Fetch User"})]})}),e.jsx(H,{}),e.jsx(o,{sx:{px:3,py:1,bgcolor:b(r.palette.warning.main,.1),borderTop:`3px solid ${r.palette.warning.main}`,borderBottom:`3px solid ${r.palette.warning.main}`},children:e.jsx(l,{variant:"body2",color:"warning.dark",fontWeight:600,textAlign:"center",children:"*".repeat(70)})}),e.jsx(o,{sx:{p:3},children:e.jsxs(W,{spacing:3,children:[e.jsxs(o,{children:[e.jsx(l,{variant:"body1",fontWeight:600,color:"info.main",gutterBottom:!0,children:"First Name:"}),e.jsx(T,{value:s?.firstName||"",disabled:!0,fullWidth:!0,variant:"outlined",sx:{"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:r.palette.primary.main,fontWeight:600},"& .MuiOutlinedInput-root.Mui-disabled":{bgcolor:b(r.palette.primary.main,.05),"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main}}}})]}),e.jsxs(o,{children:[e.jsx(l,{variant:"body1",fontWeight:600,color:"info.main",gutterBottom:!0,children:"Last Name:"}),e.jsx(T,{value:s?.lastName||"",disabled:!0,fullWidth:!0,variant:"outlined",sx:{"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:r.palette.primary.main,fontWeight:600},"& .MuiOutlinedInput-root.Mui-disabled":{bgcolor:b(r.palette.primary.main,.05),"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main}}}})]}),e.jsxs(o,{children:[e.jsx(l,{variant:"body1",fontWeight:600,color:"info.main",gutterBottom:!0,children:"User Type:"}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(T,{value:s?.userType||"",disabled:!0,sx:{width:80,"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:r.palette.primary.main,fontWeight:600,textAlign:"center"},"& .MuiOutlinedInput-root.Mui-disabled":{bgcolor:b(r.palette.primary.main,.05),"& .MuiOutlinedInput-notchedOutline":{borderColor:r.palette.primary.main}}}}),s&&e.jsx(V,{label:S(s.userType),size:"small",color:s.userType==="A"?"error":"primary",icon:s.userType==="A"?e.jsx(q,{}):e.jsx(J,{}),variant:"outlined"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"(A=Admin, U=User)"})]})]})]})}),u&&e.jsx(o,{sx:{px:3,pb:2},children:e.jsx(Q,{severity:c||"info",sx:{borderRadius:2},children:u})}),e.jsx(o,{sx:{p:3,bgcolor:b(r.palette.grey[100],.5),borderTop:`1px solid ${r.palette.divider}`},children:e.jsxs(W,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,children:[e.jsxs(W,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(X,{}),onClick:p,disabled:d||!m.userId.trim(),size:"small",children:"ENTER = Fetch"}),e.jsx(y,{variant:"contained",startIcon:e.jsx(M,{}),onClick:()=>h(!0),disabled:d||!v,color:"error",size:"small",children:"F5 = Delete"})]}),e.jsxs(W,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(y,{variant:"outlined",startIcon:e.jsx(Y,{}),onClick:i,disabled:d,size:"small",children:"F4 = Clear"}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(Z,{}),onClick:f,disabled:d,size:"small",children:"F3 = Back"})]})]})})]}),e.jsxs(_,{open:x,onClose:()=>h(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ee,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(F,{color:"error"}),"Confirm User Deletion"]}),e.jsxs(re,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Are you sure you want to delete the following user?"}),s&&e.jsxs(o,{sx:{mt:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"User ID:"})," ",s.userId]}),e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Name:"})," ",s.firstName," ",s.lastName]}),e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Type:"})," ",S(s.userType)]})]}),e.jsxs(l,{variant:"body2",color:"error",sx:{mt:2},children:[e.jsx("strong",{children:"Warning:"})," This action cannot be undone."]})]}),e.jsxs(te,{children:[e.jsx(y,{onClick:()=>h(!1),variant:"outlined",children:"Cancel"}),e.jsx(y,{onClick:k,variant:"contained",color:"error",startIcon:e.jsx(M,{}),children:"Delete User"})]})]})]})})}function le(m={}){const j=ne(),[d]=ae(),u=d.get("userId")||"",[c,s]=a.useState({userId:u}),[g,p]=a.useState({}),[I,i]=a.useState(null),[f,r]=a.useState(null),[x,h]=a.useState(null),C=!0,{mutate:U,loading:k}=A(async t=>{if(console.log("ðŸ” Fetching user for deletion:",{userId:t,useMocks:C}),C)return E.get(`/users/security/${t}`)},{onSuccess:t=>{console.log("âœ… User fetched for deletion:",t),h(t),i("Press F5 key to delete this user ..."),r("info"),p({})},onError:t=>{console.error("âŒ Error fetching user for deletion:",t),h(null),i(t),r("error"),m.onError?.(t)}}),{mutate:v,loading:S}=A(async t=>{if(console.log("ðŸ—‘ï¸ Deleting user:",{userId:t,useMocks:C}),C)return E.delete(`/users/security/${t}`)},{onSuccess:t=>{console.log("âœ… User deleted successfully:",t),i(t.message||`User ${c.userId} has been deleted ...`),r("success"),h(null),s({userId:""}),m.onSuccess?.(t.message||`User ${c.userId} has been deleted ...`)},onError:t=>{console.error("âŒ Error deleting user:",t),i(t),r("error"),m.onError?.(t)}}),n=a.useCallback(()=>{const t={};return c.userId.trim()||(t.userId="User ID can NOT be empty..."),p(t),Object.keys(t).length===0},[c]),O=a.useCallback((t,P)=>{s(w=>({...w,[t]:P})),g[t]&&p(w=>{const D={...w};return delete D[t],D})},[g]),B=a.useCallback(()=>{if(!n()){i("User ID can NOT be empty..."),r("error");return}U(c.userId.trim())},[c.userId,U,n]),N=a.useCallback(()=>{if(!x){i("No user selected for deletion..."),r("error");return}v(x.userId)},[x,v]),$=a.useCallback(()=>{s({userId:""}),h(null),p({}),i(null),r(null)},[]),R=a.useCallback(()=>{j("/admin/users/list")},[j]);return a.useEffect(()=>{u&&!x&&!k&&(console.log("ðŸš€ Auto-fetching user for deletion from URL params:",u),U(u))},[u,x,k,U]),{formData:c,errors:g,loading:k||S,message:I,messageType:f,userData:x,handleFormChange:O,handleFetchUser:B,handleDelete:N,handleClear:$,handleExit:R,canDelete:x!==null,isValid:Object.keys(g).length===0}}function be(){const{formData:m,errors:j,loading:d,message:u,messageType:c,userData:s,handleFormChange:g,handleFetchUser:p,handleDelete:I,handleClear:i,handleExit:f}=le({onError:r=>{console.error("User delete error:",r)},onSuccess:r=>{console.log("User delete success:",r)}});return d&&!s?e.jsx(ie,{}):e.jsx(oe,{formData:m,errors:j,loading:d,message:u,messageType:c,userData:s,onFormChange:g,onFetchUser:p,onDelete:I,onClear:i,onExit:f})}export{be as default};
