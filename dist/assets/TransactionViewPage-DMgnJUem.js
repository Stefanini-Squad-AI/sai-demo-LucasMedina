import{u as W,j as a,a as z,B as l,P as L,g as F,aC as P,b as r,G as A,S as T,i as V,k as $,d as C,D as O,at as U,N as m,U as S,W as D,h as H,av as K,Z,X as N,au as G,ay as X,az as J,A as R,ae as Q,aD as Y,y as _,aB as q}from"./mui-bVcw8cZ8.js";import{r as o}from"./vendor-BPyidg2q.js";import{S as aa}from"./SystemHeader-DB4NlgIL.js";import{u as B}from"./useApi-EeZ7am_M.js";import{g as M}from"./index-85Pf7yId.js";import{u as ra,c as na}from"./router-DEfLtG0k.js";import"./redux-B6kvt0Aa.js";function ea(c={}){const d=ra(),[s,x]=o.useState({searchTransactionId:c.initialTransactionId||"",transactionData:null,validationErrors:{}}),[t,y]=o.useState(!1),{mutate:h,loading:f,error:p}=B(async e=>(console.log("ðŸ” Searching transaction:",e.transactionId),await M.get(`/transaction-view/search?transactionId=${e.transactionId}`)),{onSuccess:e=>{if(console.log("âœ… Transaction search result:",e),e.errorMessage){const i=e.errorMessage;x(w=>({...w,validationErrors:{searchTransactionId:i},transactionData:null}));return}x(i=>({...i,transactionData:e,validationErrors:{}}))},onError:e=>{console.error("âŒ Transaction search error:",e),x(i=>({...i,validationErrors:{searchTransactionId:e},transactionData:null})),c.onError?.(e)}}),{mutate:I,loading:j}=B(async()=>await M.post("/transaction/clear"),{onSuccess:e=>{x(i=>({...i,searchTransactionId:"",transactionData:e,validationErrors:{}}))}}),u=o.useCallback(e=>{const i={};return(!e||e.trim()==="")&&(i.searchTransactionId="Transaction ID cannot be empty..."),x(w=>({...w,validationErrors:i})),Object.keys(i).length===0},[]),g=o.useCallback(async()=>{u(s.searchTransactionId)&&await h({transactionId:s.searchTransactionId.trim()})},[s.searchTransactionId,u,h]),v=o.useCallback(e=>{x(i=>({...i,searchTransactionId:e,validationErrors:{...i.validationErrors,searchTransactionId:""}}))},[]),k=o.useCallback(async()=>{await I({})},[I]),E=o.useCallback(()=>{d("/transactions/list")},[d]),b=o.useCallback(()=>{d("/menu/main")},[d]),n=o.useCallback(async()=>{const e=c.initialTransactionId;e&&!t&&(console.log("ðŸš€ Loading initial transaction:",e),y(!0),u(e)&&await h({transactionId:e}))},[c.initialTransactionId,t,u,h]);return o.useEffect(()=>{c.initialTransactionId&&!t&&n()},[c.initialTransactionId,t,n]),{...s,loading:f||j,error:p,handleSearch:g,handleSearchChange:v,handleClearScreen:k,handleBrowseTransactions:E,handleExit:b,handleInitialLoad:n}}function ta({initialTransactionId:c,onError:d}){const s=W(),{searchTransactionId:x,transactionData:t,validationErrors:y,loading:h,error:f,handleSearch:p,handleSearchChange:I,handleClearScreen:j,handleBrowseTransactions:u,handleExit:g,handleInitialLoad:v}=ea({...c&&{initialTransactionId:c},...d&&{onError:d}});o.useEffect(()=>{c&&v()},[v,c]);const k=o.useCallback(n=>{n.key==="F3"?(n.preventDefault(),g()):n.key==="F4"?(n.preventDefault(),j()):n.key==="F5"?(n.preventDefault(),u()):n.key==="Enter"&&n.target===n.currentTarget&&(n.preventDefault(),p())},[g,j,u,p]),E=o.useCallback(n=>{if(!n)return"";try{const e=parseFloat(n);return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e)}catch{return n}},[]),b=o.useCallback(n=>{if(!n)return"";try{return new Date(n).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return n}},[]);return a.jsx(z,{maxWidth:"xl",sx:{py:3},children:a.jsxs(l,{onKeyDown:k,tabIndex:-1,children:[a.jsx(aa,{transactionId:"CT01",programName:"COTRN01C",title:"View Transaction",subtitle:"CardDemo - Transaction View"}),a.jsxs(L,{elevation:2,sx:{borderRadius:3,overflow:"hidden",background:`linear-gradient(145deg, ${F(s.palette.background.paper,.9)}, ${F(s.palette.background.default,.1)})`},children:[a.jsxs(l,{sx:{p:3,textAlign:"center",background:`linear-gradient(135deg, ${s.palette.primary.main}, ${s.palette.secondary.main})`,color:"white"},children:[a.jsx(P,{sx:{fontSize:48,mb:2}}),a.jsx(r,{variant:"h5",fontWeight:600,children:"View Transaction"}),a.jsx(r,{variant:"body2",sx:{opacity:.9,mt:1},children:"Enter Transaction ID to view details"})]}),a.jsxs(l,{sx:{p:4},children:[a.jsxs(l,{sx:{mb:4},children:[a.jsxs(r,{variant:"h6",color:"primary.main",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(A,{}),"Enter Transaction ID"]}),a.jsxs(T,{direction:"row",spacing:2,alignItems:"flex-start",children:[a.jsx(V,{label:"Enter Tran ID",value:x,onChange:n=>I(n.target.value),error:!!y.searchTransactionId,helperText:y.searchTransactionId||"Enter Transaction ID to search",disabled:h,placeholder:"Enter Transaction ID",inputProps:{maxLength:16,style:{fontFamily:"monospace"}},InputProps:{startAdornment:a.jsx($,{position:"start",children:a.jsx(A,{color:"primary"})})},sx:{flex:1,maxWidth:400,"& .MuiOutlinedInput-root":{borderRadius:2}},onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),p())}}),a.jsx(C,{variant:"contained",onClick:p,disabled:h,startIcon:a.jsx(A,{}),sx:{borderRadius:2,px:3,py:1.5},children:"Search"})]})]}),a.jsx(O,{sx:{my:3}}),t&&!y.searchTransactionId&&a.jsxs(l,{sx:{mb:4},children:[a.jsxs(r,{variant:"h6",color:"primary.main",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(U,{}),"Transaction Details"]}),a.jsxs(m,{container:!0,spacing:3,children:[a.jsx(m,{item:!0,xs:12,md:6,children:a.jsx(S,{variant:"outlined",sx:{height:"100%"},children:a.jsxs(D,{children:[a.jsx(r,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,color:"primary.main",children:"Basic Information"}),a.jsxs(T,{spacing:2,children:[a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Transaction ID"}),a.jsx(r,{variant:"body1",fontFamily:"monospace",fontWeight:600,children:t.transactionId||"N/A"})]}),a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Card Number"}),a.jsxs(r,{variant:"body1",fontFamily:"monospace",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(H,{fontSize:"small",color:"primary"}),t.cardNumber||"N/A"]})]}),a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Type Code"}),a.jsx(r,{variant:"body1",fontFamily:"monospace",children:t.transactionTypeCode||"N/A"})]}),a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Category Code"}),a.jsxs(r,{variant:"body1",fontFamily:"monospace",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(K,{fontSize:"small",color:"primary"}),t.transactionCategoryCode||"N/A"]})]}),a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Source"}),a.jsx(r,{variant:"body1",children:t.transactionSource||"N/A"})]})]})]})})}),a.jsx(m,{item:!0,xs:12,md:6,children:a.jsx(S,{variant:"outlined",sx:{height:"100%"},children:a.jsxs(D,{children:[a.jsx(r,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,color:"primary.main",children:"Financial Information"}),a.jsxs(T,{spacing:2,children:[a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Amount"}),a.jsxs(r,{variant:"h6",fontFamily:"monospace",fontWeight:600,color:t.transactionAmount&&parseFloat(t.transactionAmount)<0?"error.main":"success.main",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(Z,{fontSize:"small"}),E(t.transactionAmount)]})]}),a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Original Date"}),a.jsxs(r,{variant:"body1",fontFamily:"monospace",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(N,{fontSize:"small",color:"primary"}),b(t.originalTimestamp)]})]}),a.jsxs(l,{children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Processed Date"}),a.jsxs(r,{variant:"body1",fontFamily:"monospace",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(N,{fontSize:"small",color:"primary"}),b(t.processedTimestamp)]})]})]})]})})}),a.jsx(m,{item:!0,xs:12,children:a.jsx(S,{variant:"outlined",children:a.jsxs(D,{children:[a.jsx(r,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,color:"primary.main",children:"Description"}),a.jsx(r,{variant:"body1",children:t.transactionDescription||"No description available"})]})})}),a.jsx(m,{item:!0,xs:12,children:a.jsx(S,{variant:"outlined",children:a.jsxs(D,{children:[a.jsxs(r,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,color:"primary.main",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(G,{}),"Merchant Information"]}),a.jsxs(m,{container:!0,spacing:3,children:[a.jsxs(m,{item:!0,xs:12,sm:6,md:3,children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Merchant ID"}),a.jsxs(r,{variant:"body1",fontFamily:"monospace",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(X,{fontSize:"small",color:"primary"}),t.merchantId||"N/A"]})]}),a.jsxs(m,{item:!0,xs:12,sm:6,md:3,children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Merchant Name"}),a.jsx(r,{variant:"body1",children:t.merchantName||"N/A"})]}),a.jsxs(m,{item:!0,xs:12,sm:6,md:3,children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"City"}),a.jsxs(r,{variant:"body1",sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(J,{fontSize:"small",color:"primary"}),t.merchantCity||"N/A"]})]}),a.jsxs(m,{item:!0,xs:12,sm:6,md:3,children:[a.jsx(r,{variant:"caption",color:"text.secondary",children:"Zip Code"}),a.jsx(r,{variant:"body1",fontFamily:"monospace",children:t.merchantZip||"N/A"})]})]})]})})})]})]}),f&&a.jsx(R,{severity:"error",sx:{mb:3,borderRadius:2},children:f}),a.jsxs(T,{direction:"row",spacing:2,justifyContent:"center",flexWrap:"wrap",children:[a.jsx(C,{variant:"outlined",onClick:j,disabled:h,startIcon:a.jsx(Q,{}),sx:{borderRadius:2,px:3},children:"F4 = Clear"}),a.jsx(C,{variant:"outlined",onClick:u,disabled:h,startIcon:a.jsx(Y,{}),sx:{borderRadius:2,px:3},children:"F5 = Browse Tran."}),a.jsx(C,{variant:"outlined",color:"error",onClick:g,disabled:h,startIcon:a.jsx(_,{}),sx:{borderRadius:2,px:3},children:"F3 = Back"})]})]}),a.jsx(l,{sx:{p:2,bgcolor:F(s.palette.grey[100],.5),borderTop:`1px solid ${s.palette.divider}`,textAlign:"center"},children:a.jsx(r,{variant:"body2",color:"text.secondary",children:"ENTER = Fetch â€¢ F3 = Back â€¢ F4 = Clear â€¢ F5 = Browse Tran."})})]})]})})}function ha(){const{transactionId:c}=na(),[d,s]=o.useState(null),x=t=>{s(t)};return a.jsxs(a.Fragment,{children:[a.jsx(ta,{...c&&{initialTransactionId:c},onError:x}),a.jsx(q,{open:!!d,autoHideDuration:6e3,onClose:()=>s(null),anchorOrigin:{vertical:"top",horizontal:"center"},children:a.jsx(R,{onClose:()=>s(null),severity:"error",variant:"filled",sx:{width:"100%"},children:d})})]})}export{ha as default};
